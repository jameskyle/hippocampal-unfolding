% mrMarkArea

load mrMarkArea

markAreaFig = figure('Units','points', ...
	'Color',[0.8 0.8 0.8], ...
	'Colormap',mat0, ...
	'Position',[686.7 98.1 243.9 359.1], ...
	'Tag','Fig3');
h1 = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'FontSize',12, ...
	'ListboxTop',0, ...
	'Position',[60.3 330.3 127.8 22.5], ...
	'String','Mark Selected Area', ...
	'Style','text', ...
	'Tag','StaticText1');

%%%%%%%%%% File Menu %%%%%%%%%%
set(markAreaFig,'MenuBar','none');

fileMenu = uimenu('Parent',markAreaFig,'Label','&File');

load_menu = uimenu(fileMenu,'Label','&Load Selected Area Voxels',...
	'Separator','on',...
	'Callback',[...
	    'changeDir(saveDir);,'...
	    'areaName = get(areaBtnList(mVoxelsStruct.selected),''String'');',...
	    'mVoxelsStruct = mrLoadMarkedVoxels(mVoxelsStruct,areaName,grayMatter);,'...
	    'changeDir(curDir);,'...
	    'displayStruct.flags = [-1 1 -1 1 -1];,'...
	    'mrChangeImageScript;']);

save_menu = uimenu(fileMenu,'Label','&Save Selected Area Voxels',...
	'Callback',[...
	    'changeDir(saveDir);,'...
	    'areaName = get(areaBtnList(mVoxelsStruct.selected),''String'');',...
	    'mrSaveMarkedVoxels(mVoxelsStruct,areaName,grayMatter);,'...
	    'changeDir(curDir);']);
	
clear_menu = uimenu(fileMenu,'Label','&Clear Selected Area Voxels',...
	'Callback',[...
	    'mVoxelsStruct = mrClearMarkedVoxels(mVoxelsStruct);,'...
	    'mrChangeImageScript;']);

close_menu = uimenu(fileMenu,'Label','&Quit Mark Area Tool',...
	'Separator','on',...
	'Callback','close figure(gcf)');

%%%%%%%%%% Select & name area to edit %%%%%%%%%%
h1 = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[34.2 303.3 156.6 14.4], ...
	'String','Select and name an area to edit:', ...
	'Style','text', ...
	'Tag','StaticText2');

areaBtnList(1) = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[33.3 277.2 18 20.7], ...
	'Style','radiobutton', ...
	'Tag','Radiobutton1', ...
	'Callback',['mVoxelsStruct.selected = 1;,'...
		'areaBtnList = setBtnsOff(areaBtnList,1);']);
area1_name = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'HorizontalAlignment','center', ...
	'ListboxTop',0, ...
	'Position',[55.8 276.3 47.7 20.7], ...
	'Style','edit', ...
	'Tag','EditText1',...
	'String','Area1');
	
areaBtnList(2) = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[33.3 245.7 18 20.7], ...
	'Style','radiobutton', ...
	'Tag','Radiobutton1', ...
	'Callback',['mVoxelsStruct.selected = 2;,'...
		'areaBtnList = setBtnsOff(areaBtnList,2);']);
area2_name = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'HorizontalAlignment','center', ...
	'ListboxTop',0, ...
	'Position',[55.8 244.8 47.7 20.7], ...
	'Style','edit', ...
	'Tag','EditText1',...
	'String','Area2');
	
areaBtnList(3) = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[33.3 212.3 18 20.7], ...
	'Style','radiobutton', ...
	'Tag','Radiobutton1', ...
	'Callback',['mVoxelsStruct.selected = 3;,'...
		'areaBtnList = setBtnsOff(areaBtnList,3);']);
area3_name = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'HorizontalAlignment','center', ...
	'ListboxTop',0, ...
	'Position',[55.8 212.4 47.7 20.7], ...
	'Style','edit', ...
	'Tag','EditText1',...
	'String','Area3');
	
areaBtnList(4) = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[135 277.2 18 20.7], ...
	'Style','radiobutton', ...
	'Tag','Radiobutton1', ...
	'Callback',['mVoxelsStruct.selected = 4;,'...
		'areaBtnList = setBtnsOff(areaBtnList,4);']);
area4_name = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'HorizontalAlignment','center', ...
	'ListboxTop',0, ...
	'Position',[157.5 276.3 47.7 20.7], ...
	'Style','edit', ...
	'Tag','EditText1',...
	'String','Area4');
	
areaBtnList(5) = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[135 246.6 18 20.7], ...
	'Style','radiobutton', ...
	'Tag','Radiobutton1', ...
	'Callback',['mVoxelsStruct.selected = 5;,'...
		'areaBtnList = setBtnsOff(areaBtnList,5);']);
area5_name = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'HorizontalAlignment','center', ...
	'ListboxTop',0, ...
	'Position',[157.5 245.7 47.7 20.7], ...
	'Style','edit', ...
	'Tag','EditText1',...
	'String','Area5');
	
areaBtnList(6) = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[135 212.3 18 20.7], ...
	'Style','radiobutton', ...
	'Tag','Radiobutton1', ...
	'Callback',['mVoxelsStruct.selected = 6;,'...
		'areaBtnList = setBtnsOff(areaBtnList,6);']);
area6_name = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'HorizontalAlignment','center', ...
	'ListboxTop',0, ...
	'Position',[157.5 212.4 47.7 20.7], ...
	'Style','edit', ...
	'Tag','EditText1',...
	'String','Area6');

%%%%%%%%%% Tools for editing %%%%%%%%%%
h1 = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[33.3 183.6 156.6 14.4], ...
	'String','Tools for editing:', ...
	'Style','text', ...
	'Tag','StaticText2');
	
mark1x1 = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'ListboxTop',0, ...
	'Position',[63.89999999999999 153 121.5 25.2], ...
	'String','Mark 1x1 voxel', ...
	'Tag','Pushbutton1',...
	'Interruptible','on',...
	'Callback',[...
	    'disp(''Mark voxels with left mouse button; unmark voxels with middle button.  Press right button when finished.'');,'...
	    'setVisiblesOff;,'...
	    'displayStruct.flags(1) = -1; displayStruct.flags(3) = -1;,'...
	    '[displayStruct.flags(2),imgStruct] = mrOverlayGray(volStruct,displayStruct,grayStruct.nodes(1:3,:),-1,cutNodes,mVoxelsStruct,h_fig2);,'...
	    'displayStruct.flags(4) = 1;,'...
	    'isDone = 0;,'...
	    'while (isDone == 0),'...
	      'figure(h_fig2),'...
	      '[c r button] = ginput(1);,'...
	      'c = round(c); r = round(r);,'...
 	      '[mVoxelsStruct, isDone] = addMarkedVoxel(c,r,button,mVoxelsStruct,displayStruct,grayStruct,volStruct,h_fig2);,'...
	      'mrChangeImageScript;,'...
	    'end,'...
	    'setVisiblesOn;']);

mark2x2 = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'ListboxTop',0, ...
	'Position',[63.89999999999999 119.7 121.5 25.2], ...
	'String','Mark 2x2 voxel', ...
	'Tag','Pushbutton1',...
	'Interruptible','on',...
	'Callback',[...
	    'disp(''Mark voxels with left mouse button; unmark voxels with middle button.  Press right button when finished.'');,'...
	    'setVisiblesOff;,'...
	    'displayStruct.flags(1) = -1; displayStruct.flags(3) = -1;,'...
	    '[displayStruct.flags(2),imgStruct] = mrOverlayGray(volStruct,displayStruct,grayStruct.nodes(1:3,:),-1,cutNodes,mVoxelsStruct,h_fig2);,'...
	    'displayStruct.flags(4) = 1;,'...
	    'isDone = 0;,'...
	    'while (isDone == 0),'...
	      'figure(h_fig2),'...
	      '[c r button] = ginput(1);,'...
	      'c = round(c); r = round(r);,'...
 	      '[mVoxelsStruct, isDone] = addMarked2by2Voxels(c,r,button,mVoxelsStruct,displayStruct,grayStruct,volStruct,h_fig2);,'...
	      'mrChangeImageScript;,'...
	    'end,'...
	    'setVisiblesOn;']);

markRect = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'ListboxTop',0, ...
	'Position',[63.89999999999999 86.39999999999999 121.5 25.2], ...
	'String','Mark Rectangle', ...
	'Tag','Pushbutton1',...
	'Interruptible','on',...
	'Callback',[...
	    'setVisiblesOff;,'...
	    'displayStruct.flags(1) = -1; displayStruct.flags(3) = -1;,'...
	    '[displayStruct.flags(2),imgStruct] = mrOverlayGray(volStruct,displayStruct,grayStruct.nodes(1:3,:),-1,cutNodes,mVoxelsStruct,h_fig2);,'...
	    'displayStruct.flags(4) = 1;,'...
	    'rect = getrect(h_fig2);,'...
	    'mVoxelsStruct = addMarkedRect(rect,mVoxelsStruct,displayStruct,grayStruct,volStruct,h_fig2);,'...
	    'mrChangeImageScript;,'...
	    'setVisiblesOn;']);

saveArea = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'ListboxTop',0, ...
	'Position',[20.7 23.4 97.19999999999999 25.2], ...
	'String','Save Area', ...
	'Tag','Pushbutton1',...
	'Callback',[...
	    'changeDir(saveDir);,'...
	    'areaName = get(areaBtnList(mVoxelsStruct.selected),''String'');',...
	    'mrSaveMarkedVoxels(mVoxelsStruct,areaName,grayMatter);,'...
	    'changeDir(curDir);']);

clearArea = uicontrol('Parent',markAreaFig, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'ListboxTop',0, ...
	'Position',[129.6 23.4 96.3 25.2], ...
	'String','Clear Area', ...
	'Tag','Pushbutton1',...
	'Callback',[...
	    'mVoxelsStruct = mrClearMarkedVoxels(mVoxelsStruct);,'...
	    'mrChangeImageScript;']);


