% mrUnfoldGUI.m
% script
%
% 05.03.98 SJC
%
% PURPOSE:	Visual interface for unfolding gray matter data.  Creates
%		a parameters file from data entered by user and calls
%		unfolding program to flatten data.
%

load mrUnfoldGUI

h0 = figure('Units','points', ...
	'Color',[0.8 0.8 0.8], ...
	'Colormap',mat0, ...
	'MenuBar','none',...
	'Name','Unfold',...
	'Position',[556.2 85.5 440 280], ...
	'Tag','Fig5');
title_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'FontSize',12, ...
	'ListboxTop',0, ...
	'Position',[140 250 200 16.7], ...
	'String','Unfolding Parameters', ...
	'Style','text', ...
	'Tag','StaticText3');

xCoord0 = 100;
xCoord1 = 25;
xCoord2 = 34;
xCoord3 = 100;
xCoord4 = 295;
xCoord5 = 375;

display_chk = uicontrol('Parent',h0, ...
	'Units','points', ...
	'ListboxTop',0, ...
	'Position',[xCoord0 73 123 21.6], ...
	'String','Display Unfold Results', ...
	'Style','checkbox', ...
	'Tag','Checkbox1');
save_chk = uicontrol('Parent',h0, ...
	'Units','points', ...
	'ListboxTop',0, ...
	'Position',[xCoord0 44 123 21.6], ...
	'String','Save Auxiliary data', ...
	'Style','checkbox', ...
	'Tag','Checkbox1');
	
paramsFile_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'ListboxTop',0, ...
	'Position',[xCoord1 212 68.39999999999999 25.6], ...
	'String','Filename for parameters', ...
	'Style','text', ...
	'Tag','StaticText1');
paramsFile_edit = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'HorizontalAlign','left',...
	'ListboxTop',0, ...
	'Position',[xCoord3 214 93.6 22.5], ...
	'Style','edit', ...
	'String','ParamsFile.m',...
	'Tag','EditText2');
	
unfSaveDir_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'ListboxTop',0, ...
	'Position',[xCoord1 184 68.39999999999999 25.6], ...
	'String','Save directory for unfold data', ...
	'Style','text', ...
	'Tag','StaticText1');
unfSaveDir_edit = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'HorizontalAlign','left',...
	'ListboxTop',0, ...
	'Position',[xCoord3 186 190 22.5], ...
	'Style','edit', ...
	'String',sprintf('%s/%s/unfold',anatomy.dir,grayMatter.hemisphere),...
	'Tag','EditText1');

load_btn = uicontrol('Parent',h0,...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'ListboxTop',0, ...
	'Position',[xCoord3 160 123 21.6], ...
	'Tag','Pushbutton1',...
	'String','Load parameters file',...
	'Callback','mrLoadUnfoldParams');

dimdist_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'ListboxTop',0, ...
	'Position',[xCoord2 128 68.39999999999999 25.6], ...
	'String','Voxel dimensions', ...
	'Style','text', ...
	'Tag','StaticText1');
dimdist_edit = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'ListboxTop',0, ...
	'Position',[xCoord3 130 150 22.5], ...
	'Style','edit', ...
	'String',num2str(volStruct.dimdist),...
	'Tag','EditText1');
	
plane_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'ListboxTop',0, ...
	'Position',[xCoord2 100 68.39999999999999 25.6], ...
	'String','Flattening plane', ...
	'Style','text', ...
	'Tag','StaticText1');
plane_edit = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'ListboxTop',0, ...
	'Position',[xCoord3 102 94.49999999999999 22.5], ...
	'Style','edit', ...
	'String','-1   1   0',...
	'Tag','EditText1');

sampSpacing_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'ListboxTop',0, ...
	'Position',[xCoord4 212 68.39999999999999 25.6], ...
	'String','Sub-sampling ratio', ...
	'Style','text', ...
	'Tag','StaticText1');
sampSpacing_edit = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'ListboxTop',0, ...
	'Position',[xCoord5 214 35.09999999999999 22.5], ...
	'Style','edit', ...
	'String','3.0',...
	'Tag','EditText2');

nIter_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'ListboxTop',0, ...
	'Position',[xCoord4 184 68.39999999999999 25.6], ...
	'String','Maximum iterations', ...
	'Style','text', ...
	'Tag','StaticText1');
nIter_edit = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'ListboxTop',0, ...
	'Position',[xCoord5 186 35.09999999999999 22.5], ...
	'Style','edit', ...
	'String','15',...
	'Tag','EditText2');

rSamp_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'ListboxTop',0, ...
	'Position',[xCoord4 156 68.39999999999999 25.6], ...
	'String','Number of neighbors', ...
	'Style','text', ...
	'Tag','StaticText1');
rSamp_edit = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'ListboxTop',0, ...
	'Position',[xCoord5 158 35.09999999999999 22.5], ...
	'Style','edit', ...
	'String','35',...
	'Tag','EditText2');

flatWeight_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'ListboxTop',0, ...
	'Position',[xCoord4 124 68.39999999999999 25.6], ...
	'String','Flat weight', ...
	'Style','text', ...
	'Tag','StaticText1');
flatWeight_edit = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'ListboxTop',0, ...
	'Position',[xCoord5 130 35.09999999999999 22.5], ...
	'Style','edit', ...
	'String','12',...
	'Tag','EditText2');
	
penaltyFunc_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'ListboxTop',0, ...
	'Position',[xCoord4 96 69.3 25.6], ...
	'String','Penalty function', ...
	'Style','text', ...
	'Tag','StaticText2');
penaltyFunc_edit = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'ListboxTop',0, ...
	'Position',[xCoord5 102 35.09999999999999 22.5], ...
	'Style','edit', ...
	'String','1',...
	'Tag','EditText2');

M_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'ListboxTop',0, ...
	'Position',[xCoord4 73 69.3 21.6], ...
	'String','M', ...
	'Style','text', ...
	'Tag','StaticText2');
M_edit = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'ListboxTop',0, ...
	'Position',[xCoord5 74 35.09999999999999 22.5], ...
	'Style','edit', ...
	'String','100',...
	'Tag','EditText2');

rSeed_txt = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'ListboxTop',0, ...
	'Position',[xCoord4 44 69.3 21.6], ...
	'String','rSeed', ...
	'Style','text', ...
	'Tag','StaticText2');
rSeed_edit = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[1 1 1], ...
	'ListboxTop',0, ...
	'Position',[xCoord5 46 35.09999999999999 22.5], ...
	'Style','edit', ...
	'String','0',...
	'Tag','EditText2');

unfold_btn = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'FontSize',14, ...
	'ListboxTop',0, ...
	'Position',[xCoord3 9 90 27], ...
	'String','Unfold', ...
	'Tag','Pushbutton1',...
	'Callback',['mrSaveUnfoldParams;',...
		'curDir = pwd;',...
		'changeDir(params.unfSaveDir);',...
		'Unfold;',...
		'changeDir(curDir);']);

cancel_btn = uicontrol('Parent',h0, ...
	'Units','points', ...
	'BackgroundColor',[0.701960784313725 0.701960784313725 0.701960784313725], ...
	'Callback','close(gcf)',...
	'FontSize',11, ...
	'ListboxTop',0, ...
	'Position',[357 10 52 25], ...
	'String','Cancel', ...
	'Tag','Pushbutton1');
